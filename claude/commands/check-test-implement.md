# check-test-implement
テスト計画の実装状況をレビューし、実際の稼働プログラムとの整合性を検証

## 概要
testPlan.mdに記載されたテスト計画と実際のテスト実装を照合し、稼働プログラムが適切にテストされているかを検証します。テストカバレッジ、テスト品質、実装漏れを詳細にレポートします。

## 実行内容

### 0. 初期チェック
- `docs/testing/testPlan.md`の存在確認
- テストファイルの検出と一覧化
- 実行可能なテストの確認
- テスト環境の検証

### 1. テスト計画との照合

#### 1.1 計画されたテストの実装状況
testPlan.mdの各項目について：
- **実装済み**: 対応するテストコードが存在
- **部分実装**: 一部のみ実装されている
- **未実装**: テストコードが存在しない
- **計画外実装**: 計画にないが実装されているテスト

#### 1.2 実装状況のマッピング
```markdown
| テスト計画項目 | 実装ファイル | 実装状況 | カバレッジ | 備考 |
|--------------|------------|---------|-----------|------|
| 機能A単体テスト | test_a.py | ✅実装済み | 95% | 全ケース網羅 |
| 機能B統合テスト | - | ❌未実装 | 0% | 要実装 |
| 機能Cエラー処理 | test_c.py | ⚠️部分実装 | 60% | 異常系が不足 |
```

### 2. 稼働プログラムのテスト検証

#### 2.1 メイン機能のテストカバレッジ
- **エントリーポイント**: main関数や主要なCLIコマンド
- **コア処理**: データ処理、変換、計算ロジック
- **I/O操作**: ファイル読み書き、DB接続、API通信
- **エラーハンドリング**: 例外処理、リトライロジック

#### 2.2 実際の使用パターンの検証
```python
# 実使用例の再現テスト
def test_real_world_scenario():
    """実際のユーザー操作を模倣したテスト"""
    # 1. データ準備
    # 2. メイン処理実行
    # 3. 結果検証
    # 4. クリーンアップ
```

### 3. テスト品質の評価

#### 3.1 テストコードの品質指標
- **アサーションの適切性**: 期待値の検証が十分か
- **テストの独立性**: 各テストが独立して実行可能か
- **セットアップ/ティアダウン**: 前処理・後処理が適切か
- **モック/スタブの使用**: 外部依存の適切な分離

#### 3.2 テストの網羅性
- **正常系**: 期待される入力での動作
- **異常系**: エラー入力での動作
- **境界値**: 限界値での動作
- **パフォーマンス**: 処理速度、メモリ使用量

### 4. ギャップ分析

#### 4.1 重要な未テスト領域
優先度順にリスト化：
1. **Critical**: データ破損リスクのある機能
2. **High**: 頻繁に使用される主要機能
3. **Medium**: 通常使用される機能
4. **Low**: めったに使用されない機能

#### 4.2 テスト実装の推奨事項
```markdown
### 推奨される追加テスト

#### 1. [機能名]の境界値テスト
- **理由**: 大量データ処理時の挙動が未検証
- **テストケース**: 
  - 0件のデータ
  - 最大許容件数のデータ
  - 最大+1件のデータ
- **実装例**: 
```python
def test_boundary_values():
    # テストコード例
```

### 5. 実行可能性の検証

#### 5.1 テスト実行の確認
```bash
# Python テスト
pytest test/ -v --cov=src

# Rust テスト  
cargo test --all

# 統合テスト
python test_integration.py
```

#### 5.2 テスト実行結果の分析
- **成功率**: パス/失敗/スキップの統計
- **実行時間**: 各テストの所要時間
- **リソース使用**: メモリ、CPU、GPU使用状況
- **不安定なテスト**: 実行のたびに結果が変わるテスト

### 6. コンプライアンスチェック

#### 6.1 テスト規約の遵守
- ネーミング規則（test_*、*_test）
- ディレクトリ構造
- ドキュメンテーション
- アサーションメッセージ

#### 6.2 ベストプラクティスの適用
- AAA（Arrange-Act-Assert）パターン
- DRY原則の適用
- テストの可読性
- メンテナンス性

### 7. レポート生成

#### 7.1 実装状況サマリー
```markdown
## テスト実装状況サマリー

- **計画されたテスト総数**: 50
- **実装済み**: 35 (70%)
- **部分実装**: 8 (16%)
- **未実装**: 7 (14%)
- **計画外実装**: 5

### カバレッジ
- **全体**: 75.3%
- **コア機能**: 88.2%
- **エラーハンドリング**: 65.4%
```

#### 7.2 改善提案
1. 優先的に実装すべきテスト
2. リファクタリングが必要なテスト
3. 削除可能な冗長テスト
4. テスト環境の改善点

### 8. 継続的改善

#### 8.1 定期レビューの推奨
- 週次: 新規追加機能のテスト確認
- 月次: カバレッジレポートの確認
- 四半期: テスト戦略の見直し

#### 8.2 自動化の提案
- CI/CDパイプラインへの統合
- カバレッジの自動計測
- テスト結果の自動通知

## 出力形式
- **メインレポート**: `docs/testing/test-implementation-report.md`
- **詳細データ**: `docs/testing/test-implementation-data.json`
- **ギャップリスト**: `docs/testing/test-gaps.md`
- **実行ログ**: `docs/testing/test-execution-log.txt`
- **形式**: Markdownレポートと構造化データ
- **言語**: 日本語（技術用語は英語）

## 特徴
- テスト計画と実装の自動マッピング
- 稼働プログラムの実使用パターン検証
- テスト品質の定量的評価
- 優先度付きの改善提案
- 実行可能なテストコード例を含む

## 実行例
```bash
/check-test-implement
```

## 注意事項
- 大規模プロジェクトでは解析に時間がかかります
- テスト実行には適切な環境設定が必要です
- GPUテストは対応するハードウェアが必要です
- カバレッジツールのインストールが必要な場合があります